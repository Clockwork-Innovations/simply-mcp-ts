# Using simply-mcp as a Module

This document explains how to use `simply-mcp` as a module in other applications.

## Installation

### As an npm package (if published)
```bash
npm install simply-mcp
```

### From local directory
```bash
# In your project
npm install /path/to/simple-mcp

# Or using npm link
cd /path/to/simple-mcp
npm link
cd /path/to/your-project
npm link simply-mcp
```

## Building

Before using the module, make sure it's built:

```bash
cd /path/to/simple-mcp
npm install --legacy-peer-deps
npm run build
```

This will create the `dist/` directory with compiled JavaScript and TypeScript declarations.

## Usage

### Decorator API (Recommended)

```typescript
import { MCPServer } from 'simply-mcp';

@MCPServer({ name: 'my-server', version: '1.0.0' })
class MyServer {
  // Public methods automatically become tools
  add(a: number, b: number): number {
    return a + b;
  }

  greet(name: string, formal: boolean = false): string {
    return formal ? `Good day, ${name}` : `Hey ${name}!`;
  }
}
```

### Functional API

```typescript
import { defineMCP } from 'simply-mcp';
import { z } from 'zod';

export default defineMCP({
  name: 'my-server',
  version: '1.0.0',
  tools: [
    {
      name: 'greet',
      description: 'Greet a user',
      parameters: z.object({
        name: z.string(),
        formal: z.boolean().optional()
      }),
      execute: async (args) => {
        const greeting = args.formal
          ? `Good day, ${args.name}`
          : `Hey ${args.name}!`;
        return greeting;
      }
    }
  ]
});
```

### Programmatic API

```typescript
import { BuildMCPServer } from 'simply-mcp';
import { z } from 'zod';

const server = new BuildMCPServer({
  name: 'my-server',
  version: '1.0.0'
});

server.addTool({
  name: 'greet',
  description: 'Greet a user',
  parameters: z.object({
    name: z.string(),
    formal: z.boolean().optional()
  }),
  execute: async (args) => {
    const greeting = args.formal
      ? `Good day, ${args.name}`
      : `Hey ${args.name}!`;
    return greeting;
  }
});

// Start the server (stdio transport by default)
await server.start();

// Or start with HTTP transport
await server.start({
  transport: 'http',
  port: 3000
});
```

## TypeScript Support

The package includes full TypeScript definitions. Import types as needed:

```typescript
import type {
  HandlerContext,
  HandlerResult,
  ToolHandler,
  ServerConfig,
  SingleFileTool
} from 'simply-mcp';

const myTool: SingleFileTool = {
  name: 'example',
  description: 'An example tool',
  parameters: z.object({ input: z.string() }),
  execute: async (args) => `Got: ${args.input}`
};
```

## Available Exports

### Main Classes
- `BuildMCPServer` - Main programmatic API class
- `MCPBuilder` - Builder pattern for creating configurations
- `Schema` - Schema builder utility

### Decorators
- `@MCPServer()` - Class decorator for server configuration
- `@tool()` - Method decorator for tools
- `@prompt()` - Method decorator for prompts
- `@resource()` - Method decorator for resources

### Helper Functions
- `defineMCP()` - Define a server configuration
- `defineTool()` - Define a tool with type safety
- `definePrompt()` - Define a prompt with type safety
- `defineResource()` - Define a resource with type safety
- `createMCP()` - Create an MCP builder instance
- `schemaToZod()` - Convert schema objects to Zod schemas

### Types
- `HandlerContext`, `HandlerResult`, `ToolHandler`
- `SamplingMessage`, `SamplingOptions`, `ResourceContents`
- `TextContent`, `ImageContent`, `AudioContent`, `BinaryContent`
- `Logger`, `Permissions`, `HandlerError`
- `ServerConfig`, `SingleFileTool`, `SingleFilePrompt`, `SingleFileResource`
- `ToolMetadata`, `PromptMetadata`, `ResourceMetadata`

### Error Classes
- `HandlerExecutionError`
- `HandlerLoadError`
- `HandlerSyntaxError`
- `HandlerTimeoutError`
- `HandlerNetworkError`
- `HandlerNotFoundError`
- `HandlerConfigError`
- `HandlerPermissionError`

## Development Workflow

```bash
# Install dependencies
npm install --legacy-peer-deps

# Build the package
npm run build

# Clean build artifacts
npm run clean

# Development (run examples)
npm run dev
npm run dev:http
npm run dev:class
```

## Package Structure

```
simple-mcp/
├── dist/              # Compiled output (generated by npm run build)
│   └── mcp/
│       ├── index.js
│       ├── index.d.ts
│       └── ...
├── mcp/               # Source code
│   ├── index.ts       # Main entry point
│   ├── SimplyMCP.ts
│   ├── decorators.ts
│   ├── single-file-types.ts
│   ├── core/
│   └── ...
├── package.json
├── tsconfig.json
└── README.md
```

## Notes

- The package uses ES modules (`"type": "module"` in package.json)
- Peer dependency on `zod` (v4.x in this package, but compatible with v3.x projects via --legacy-peer-deps)
- Requires `@modelcontextprotocol/sdk` as a dependency
- TypeScript 5.x recommended for best compatibility
