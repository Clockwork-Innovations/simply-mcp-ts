/**
 * Rate Limiting System
 *
 * Implements rate limiting with support for:
 * - Fixed window strategy
 * - Sliding window strategy
 * - Per-session rate limits
 * - Per-tool rate limits
 * - Clear error messages with retry-after information
 */
import { RateLimitConfig, RateLimitResult, RateLimitStrategy } from './types.js';
/**
 * Rate limiter implementation
 */
export declare class RateLimiter {
    private config;
    private buckets;
    private readonly strategy;
    constructor(config: RateLimitConfig);
    /**
     * Check if a request should be allowed
     */
    checkLimit(sessionId: string, toolName?: string): RateLimitResult;
    /**
     * Record a request (call after checking limit)
     */
    recordRequest(sessionId: string, toolName?: string): void;
    /**
     * Fixed window rate limiting
     */
    private checkFixedWindow;
    /**
     * Record request for fixed window
     */
    private recordFixedWindow;
    /**
     * Sliding window rate limiting (more accurate but slightly more expensive)
     */
    private checkSlidingWindow;
    /**
     * Record request for sliding window
     */
    private recordSlidingWindow;
    /**
     * Get rate limit configuration for a specific tool or global
     */
    private getLimit;
    /**
     * Generate a unique key for rate limiting
     */
    private getKey;
    /**
     * Clean up old buckets to prevent memory leaks
     */
    private cleanup;
    /**
     * Reset rate limits for a specific session
     */
    resetSession(sessionId: string): void;
    /**
     * Get current rate limit status for a session
     */
    getStatus(sessionId: string, toolName?: string): RateLimitResult;
    /**
     * Get statistics about rate limiting
     */
    getStatistics(): {
        totalBuckets: number;
        strategy: RateLimitStrategy;
        enabled: boolean;
    };
}
/**
 * Create a rate limit error message
 */
export declare function createRateLimitError(result: RateLimitResult): string;
//# sourceMappingURL=RateLimiter.d.ts.map