/**
 * Access Control System
 *
 * Implements permission-based authorization with support for:
 * - Permission strings (e.g., "tools:execute", "tools:greet")
 * - Wildcard permissions (e.g., "tools:*", "*:*")
 * - Permission inheritance/hierarchy
 * - Session-based permission storage
 */
import { SecurityContext, PermissionConfig } from './types.js';
/**
 * Permission checker class for evaluating permissions
 */
export declare class PermissionChecker {
    private inheritanceRules;
    private anonymousPermissions;
    private authenticatedPermissions;
    constructor(config?: PermissionConfig);
    /**
     * Check if a permission matches a required permission
     * Supports wildcards: "tools:*" matches "tools:execute"
     */
    private matchesPermission;
    /**
     * Expand a permission to include all inherited permissions
     */
    private expandPermission;
    /**
     * Check if a context has a specific permission
     */
    hasPermission(context: SecurityContext, requiredPermission: string): boolean;
    /**
     * Check if a context has all of the specified permissions
     */
    hasAllPermissions(context: SecurityContext, requiredPermissions: string[]): boolean;
    /**
     * Check if a context has any of the specified permissions
     */
    hasAnyPermission(context: SecurityContext, requiredPermissions: string[]): boolean;
    /**
     * Get all permissions for a context (including defaults and inherited)
     */
    getAllPermissions(context: SecurityContext): string[];
    /**
     * Get required permission for a tool execution
     */
    getToolPermission(toolName: string): string;
    /**
     * Get required permission for a prompt
     */
    getPromptPermission(promptName: string): string;
    /**
     * Get required permission for a resource
     */
    getResourcePermission(resourceUri: string): string;
}
/**
 * Session-based permission storage
 */
export declare class SessionPermissionStore {
    private sessions;
    private readonly sessionTimeout;
    constructor(sessionTimeout?: number);
    /**
     * Store security context for a session
     */
    setContext(sessionId: string, context: SecurityContext): void;
    /**
     * Get security context for a session
     */
    getContext(sessionId: string): SecurityContext | undefined;
    /**
     * Remove a session's context
     */
    removeContext(sessionId: string): void;
    /**
     * Clean up expired sessions
     */
    private cleanupExpiredSessions;
    /**
     * Get number of active sessions
     */
    getActiveSessionCount(): number;
}
/**
 * Create an anonymous security context
 */
export declare function createAnonymousContext(): SecurityContext;
/**
 * Create an authenticated security context
 */
export declare function createAuthenticatedContext(apiKeyName: string, permissions: string[], sessionId?: string, ipAddress?: string, userAgent?: string): SecurityContext;
//# sourceMappingURL=AccessControl.d.ts.map