/**
 * API Key Authentication
 *
 * Implements Express middleware for API key authentication:
 * - API key validation from headers
 * - Multiple API key support
 * - Permission association with keys
 * - Authentication logging
 * - Security context creation
 */
import { Request, Response, NextFunction } from 'express';
import { AuthenticationConfig, ApiKeyConfig, SecurityContext } from './types.js';
import { AuditLogger } from './AuditLogger.js';
/**
 * Extended Express Request with security context
 */
export interface AuthenticatedRequest extends Request {
    securityContext?: SecurityContext;
}
/**
 * API Key Authentication middleware
 */
export declare class ApiKeyAuth {
    private config;
    private auditLogger?;
    private apiKeyMap;
    constructor(config: AuthenticationConfig, auditLogger?: AuditLogger);
    /**
     * Express middleware for API key authentication
     */
    middleware(): (req: AuthenticatedRequest, res: Response, next: NextFunction) => Promise<void>;
    /**
     * Validate an API key without middleware
     */
    validateApiKey(apiKey: string): ApiKeyConfig | null;
    /**
     * Get API key configuration by name
     */
    getApiKeyByName(name: string): ApiKeyConfig | null;
    /**
     * Check if a request is authenticated
     */
    isAuthenticated(req: AuthenticatedRequest): boolean;
    /**
     * Get security context from request
     */
    getSecurityContext(req: AuthenticatedRequest): SecurityContext;
    /**
     * Send authentication error response
     */
    private sendAuthenticationError;
    /**
     * Get client IP address from request
     */
    private getClientIp;
    /**
     * Generate a secure API key
     */
    static generateApiKey(): string;
    /**
     * Get authentication statistics
     */
    getStatistics(): {
        enabled: boolean;
        totalKeys: number;
        activeKeys: number;
        allowAnonymous: boolean;
    };
}
/**
 * Create Express middleware for API key authentication
 */
export declare function createAuthMiddleware(config: AuthenticationConfig, auditLogger?: AuditLogger): (req: AuthenticatedRequest, res: Response, next: NextFunction) => Promise<void>;
/**
 * Require authentication middleware (must be used after auth middleware)
 */
export declare function requireAuthentication(): (req: AuthenticatedRequest, res: Response, next: NextFunction) => void;
//# sourceMappingURL=ApiKeyAuth.d.ts.map