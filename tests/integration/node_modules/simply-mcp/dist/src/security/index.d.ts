/**
 * Security Integration Module
 *
 * Provides middleware factories and helper functions for integrating
 * the complete security system into the MCP server.
 */
import { Response, NextFunction } from 'express';
import { SecurityConfig } from './types.js';
import { ApiKeyAuth, AuthenticatedRequest } from './ApiKeyAuth.js';
import { PermissionChecker, SessionPermissionStore } from './AccessControl.js';
import { RateLimiter } from './RateLimiter.js';
import { AuditLogger } from './AuditLogger.js';
export * from './types.js';
export * from './AccessControl.js';
export * from './RateLimiter.js';
export * from './AuditLogger.js';
export * from './ApiKeyAuth.js';
/**
 * Complete security system instance
 */
export interface SecuritySystem {
    auth: ApiKeyAuth;
    permissions: PermissionChecker;
    rateLimiter: RateLimiter;
    auditLogger: AuditLogger;
    sessionStore: SessionPermissionStore;
}
/**
 * Create a complete security system from configuration
 */
export declare function createSecuritySystem(config: SecurityConfig): SecuritySystem;
/**
 * Create Express middleware for complete security system
 */
export declare function createSecurityMiddleware(config: SecurityConfig): {
    system: SecuritySystem;
    middleware: ((req: AuthenticatedRequest, res: Response, next: NextFunction) => void)[];
};
/**
 * Middleware to enforce specific permissions
 */
export declare function enforcePermissions(...requiredPermissions: string[]): (req: AuthenticatedRequest, res: Response, next: NextFunction) => void;
/**
 * Middleware to enforce rate limits
 */
export declare function enforceRateLimit(rateLimiter: RateLimiter, auditLogger: AuditLogger, toolName?: string): (req: AuthenticatedRequest, res: Response, next: NextFunction) => void;
/**
 * Helper to check permissions in request handlers
 */
export declare function checkPermission(permissions: PermissionChecker, auditLogger: AuditLogger, context: any, requiredPermission: string, resource?: string): boolean;
/**
 * Helper to create permission denied error
 */
export declare function createPermissionDeniedError(requiredPermissions: string[]): any;
/**
 * Default security configuration (secure by default)
 */
export declare function getDefaultSecurityConfig(): SecurityConfig;
/**
 * Merge user config with defaults
 */
export declare function mergeSecurityConfig(userConfig?: Partial<SecurityConfig>): SecurityConfig;
//# sourceMappingURL=index.d.ts.map