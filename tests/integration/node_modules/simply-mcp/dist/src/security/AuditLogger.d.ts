/**
 * Audit Logging System
 *
 * Provides comprehensive audit trail for security events:
 * - Tool executions
 * - Permission checks
 * - Rate limit violations
 * - Authentication attempts
 * - Structured JSON format
 * - File and console logging
 */
import { AuditConfig, AuditEventType, SecurityContext } from './types.js';
/**
 * Audit logger implementation
 */
export declare class AuditLogger {
    private config;
    private logBuffer;
    private flushInterval;
    private readonly maxBufferSize;
    constructor(config: AuditConfig);
    /**
     * Log an audit event
     */
    log(eventType: AuditEventType, result: 'success' | 'failure' | 'warning', context?: SecurityContext, details?: {
        toolName?: string;
        resource?: string;
        permissions?: string[];
        error?: string;
        ipAddress?: string;
        userAgent?: string;
        [key: string]: any;
    }): void;
    /**
     * Log authentication success
     */
    logAuthenticationSuccess(apiKeyName: string, sessionId?: string, ipAddress?: string, userAgent?: string): void;
    /**
     * Log authentication failure
     */
    logAuthenticationFailure(reason: string, ipAddress?: string, userAgent?: string): void;
    /**
     * Log missing authentication
     */
    logAuthenticationMissing(ipAddress?: string, userAgent?: string): void;
    /**
     * Log permission check
     */
    logPermissionCheck(granted: boolean, context: SecurityContext, permissions: string[], resource?: string): void;
    /**
     * Log tool execution
     */
    logToolExecution(toolName: string, context: SecurityContext, success: boolean, error?: string, duration?: number): void;
    /**
     * Log rate limit violation
     */
    logRateLimitExceeded(context: SecurityContext, toolName?: string, currentRequests?: number, maxRequests?: number): void;
    /**
     * Log rate limit warning (approaching limit)
     */
    logRateLimitWarning(context: SecurityContext, toolName?: string, currentRequests?: number, maxRequests?: number): void;
    /**
     * Log session creation
     */
    logSessionCreated(sessionId: string, context: SecurityContext): void;
    /**
     * Log session termination
     */
    logSessionTerminated(sessionId: string, reason?: string): void;
    /**
     * Log security violation
     */
    logSecurityViolation(reason: string, context?: SecurityContext, details?: any): void;
    /**
     * Flush buffered logs to file
     */
    flush(): void;
    /**
     * Ensure log directory exists
     */
    private ensureLogDirectory;
    /**
     * Rotate log file if it exceeds max size
     */
    private rotateIfNeeded;
    /**
     * Rotate log files
     */
    private rotateLogs;
    /**
     * Log entry to console
     */
    private logToConsole;
    /**
     * Sanitize details to remove sensitive data if configured
     */
    private sanitizeDetails;
    /**
     * Close the audit logger and flush remaining logs
     */
    close(): void;
    /**
     * Get audit log statistics
     */
    getStatistics(): {
        bufferedEntries: number;
        logFile: string;
        enabled: boolean;
    };
}
//# sourceMappingURL=AuditLogger.d.ts.map